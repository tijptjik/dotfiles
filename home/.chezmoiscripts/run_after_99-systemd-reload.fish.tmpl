#!/usr/bin/env fish
#
# This script is run by chezmoi on `chezmoi apply`.
# It ensures that systemd user services and timers are reloaded and enabled.

echo "Running systemd unit configuration..."
systemctl --user daemon-reload

# Enable and start the backup timer.
# --now ensures it starts immediately if not already active.
systemctl --user enable --now backup-packages.timer
echo "Common services enabled and started:"
echo "- backup-packages.timer"

{{ if .isClient -}}

set client_services "hyprpolkitagent.service" "hypridle.service" "hyprsunset.service" "hyprpaper.service" "hyprfloat.service" "hyprvoice.service"

echo
echo "Client services enabled and started:"
for service in $client_services
    systemctl --user enable --now $service
    echo "- $service"
end

{{- end }}
